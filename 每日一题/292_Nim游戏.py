"""
LeetCode 292: Nim 游戏 (Nim Game)

问题描述:
你和你的朋友，两个人一起玩 Nim 游戏：
- 桌子上有一堆石头。
- 你们轮流进行自己的回合，你作为先手。
- 每一回合，轮到的人拿掉 1 - 3 块石头。
- 拿掉最后一块石头的人就是获胜者。
假设你们每一步都是最优解。请编写一个函数，来判断你是否可以在给定石头数量为 n 的情况下赢得游戏。
如果可以赢，返回 true；否则，返回 false。

解题思路:
这是一个经典的数学游戏问题，关键在于找到必胜态和必败态的规律。

核心观察:
1. 当石头数量 n 是 4 的倍数时，先手必输
2. 当石头数量 n 不是 4 的倍数时，先手必胜

数学证明:
- 基础情况:
  - n=1,2,3: 先手可以直接拿走所有石头，必胜
  - n=4: 无论先手拿1,2,3块，后手都能拿走剩下的，先手必败
- 归纳假设:
  - 假设对于所有 k < n 的情况都成立
  - 当 n 是 4 的倍数时: 先手拿 x 块(1≤x≤3)，剩下 n-x 块不是 4 的倍数，根据归纳假设后手必胜，所以先手必败
  - 当 n 不是 4 的倍数时: 先手可以拿 (n mod 4) 块石头，使剩下的石头数是 4 的倍数，根据归纳假设后手必败，所以先手必胜

算法实现:
只需要判断 n % 4 != 0 即可

时间复杂度: O(1)
空间复杂度: O(1)

示例:
输入: n = 4
输出: false
解释: 无论先手怎么拿，后手都能赢

输入: n = 1
输出: true
解释: 先手直接拿走所有石头获胜

输入: n = 2
输出: true
解释: 先手拿走2块石头获胜
"""

class Solution:
    def canWinNim(self, n: int) -> bool:
        """
        判断在给定石头数量 n 的情况下，先手是否必胜
        
        参数:
            n: 石头数量
        
        返回:
            bool: 如果先手可以赢返回 True，否则返回 False
        """
        # 核心逻辑: 当 n 不是 4 的倍数时，先手必胜
        # 因为先手可以拿 (n % 4) 块石头，使剩下的石头数是 4 的倍数
        # 这样后手就处于必败态
        return n % 4 != 0


# 测试代码
if __name__ == "__main__":
    solution = Solution()
    
    # 测试用例
    test_cases = [
        (1, True),   # 先手直接赢
        (2, True),   # 先手直接赢
        (3, True),   # 先手直接赢
        (4, False),  # 先手必输
        (5, True),   # 先手拿1块，剩下4块给对手
        (6, True),   # 先手拿2块，剩下4块给对手
        (7, True),   # 先手拿3块，剩下4块给对手
        (8, False),  # 先手必输
        (9, True),   # 先手拿1块，剩下8块给对手
        (10, True),  # 先手拿2块，剩下8块给对手
        (11, True),  # 先手拿3块，剩下8块给对手
        (12, False), # 先手必输
    ]
    
    print("Nim游戏测试结果:")
    print("-" * 40)
    
    all_passed = True
    for n, expected in test_cases:
        result = solution.canWinNim(n)
        status = "✓" if result == expected else "✗"
        print(f"n = {n:2d}: 预期 {expected}, 实际 {result} {status}")
        if result != expected:
            all_passed = False
    
    print("-" * 40)
    if all_passed:
        print("所有测试用例通过!")
    else:
        print("有测试用例失败!")
    
    # 额外解释
    print("\n规律总结:")
    print("1. 当 n % 4 == 0 时，先手必输")
    print("2. 当 n % 4 != 0 时，先手必胜")
    print("3. 先手必胜策略: 第一次拿 (n % 4) 块石头")
